<!DOCTYPE html>
<html>
<head>
    <title>Test Authentication Flow</title>
</head>
<body>
    <h1>Test Authentication Flow</h1>
    <button onclick="loginAndRedirect()">Login as Garden Admin and Redirect</button>
    <div id="status"></div>

    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.0/dist/axios.min.js"></script>
    <script src="/static/auth-utils.js"></script>
    <script>
    async function loginAndRedirect() {
        const status = document.getElementById('status');
        status.innerHTML = 'Logging in...';
        
        try {
            const response = await axios.post('/api/auth/login', {
                email: 'admin.garden@kenyahoa.com',
                password: 'demo123'
            });
            
            if (response.data.success) {
                // Store authentication data
                AuthUtils.storeAuthData(response.data.token, response.data.user, response.data.tenant);
                
                status.innerHTML = 'Login successful! Redirecting to dashboard...';
                
                // Redirect to dashboard after a short delay
                setTimeout(() => {
                    window.location.href = '/dashboard';
                }, 1000);
            } else {
                status.innerHTML = 'Login failed: ' + response.data.message;
            }
        } catch (error) {
            console.error('Login error:', error);
            status.innerHTML = 'Login error: ' + error.message;
        }
    }
    </script>
</body>
</html>